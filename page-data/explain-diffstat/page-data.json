{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/explain-diffstat/",
    "result": {"data":{"site":{"siteMetadata":{"title":"不如走走游游"}},"markdownRemark":{"id":"0c75baa4-02a5-52ff-8e59-3e4c42ea8db6","excerpt":"diffstat 是什么？ 在 GitHub 中 diffstat 会以 5 个方块组成的柱状图（diffstat histogram）的形式展示，如封面图中的\n■■■■■。 在 Git 中的 diffstat 则是以 ++++--- 来展示。 可以通过指令  来查看。 diffstat…","html":"<h2>diffstat 是什么？</h2>\n<p>在 GitHub 中 diffstat 会以 5 个方块组成的柱状图（diffstat histogram）的形式展示，如封面图中的\n<span class=\"text-green-600\">■■■</span><span class=\"text-gray-400\">■■</span>。</p>\n<p>在 Git 中的 diffstat 则是以 <span class=\"text-green-600\">++++</span><span class=\"text-red-600\">---</span> 来展示。</p>\n<p>可以通过指令 <code class=\"language-text\">git diff --stat</code> 来查看。</p>\n<h2>diffstat 是怎么计算出来的？</h2>\n<p>约定以下 3 个名词：</p>\n<ul>\n<li>changes: 文件变更的总行数</li>\n<li>additions: 文件变更中增加的行数</li>\n<li>deletions: 文件变更减少的行数</li>\n</ul>\n<p>以及控制台输出时<a href=\"https://invisible-island.net/diffstat/manpage/diffstat.html#h2-OPTIONS\">默认的</a>柱状图最大宽度 <code class=\"language-text\">80</code> 下文以 <code class=\"language-text\">columns</code> 代替。</p>\n<p>那么计算过程的伪代码如下</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">if</span> changes <span class=\"token operator\">></span> columns\n  adjust <span class=\"token operator\">=</span> columns <span class=\"token operator\">/</span> changes\n<span class=\"token keyword\">else</span>\n  adjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token comment\"># + 字符数量，仅取整数部分</span>\naddition_char_count <span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>additions <span class=\"token operator\">*</span> adjust<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># - 字符数量，仅取整数部分</span>\ndeletion_char_count <span class=\"token operator\">=</span> floor<span class=\"token punctuation\">(</span>deletions <span class=\"token operator\">*</span> adjust<span class=\"token punctuation\">)</span></code></pre></div>\n<p>以 <code class=\"language-text\">12 changes, 8 additions, 4 deletions</code> 为例，可以得到结果为 <span class=\"text-green-600\">++++++++</span><span class=\"text-red-600\">----</span>。</p>\n<p>但如果将 <code class=\"language-text\">12 changes, 8 additions, 4 deletions</code> 的 <code class=\"language-text\">columns</code> 设置为 5 呢？</p>\n<p>这样上述公式中的 <code class=\"language-text\">adjust</code> 则会变为 <code class=\"language-text\">0.417</code>，经计算得 <code class=\"language-text\">additions</code> 为 <code class=\"language-text\">3</code>，<code class=\"language-text\">deletions</code> 为 <code class=\"language-text\">1</code>，即可得到 <span class=\"text-green-600\">■■■</span><span class=\"text-red-600\">■</span>，为了保持 5 个方块的长度，将缺少部分用灰色补充，就可以得到 GitHub 样式的 diffstat 柱状图 <span class=\"text-green-600\">■■■</span><span class=\"text-red-600\">■</span><span class=\"text-gray-400\">■</span>。</p>\n<h2>相关资料</h2>\n<ul>\n<li><a href=\"https://github.blog/2010-01-12-improved-commit-diffs/\">[GitHub Blog] Improved Commit Diffs#Diffstats</a></li>\n<li><a href=\"https://invisible-island.net/diffstat/manpage/diffstat.html\">diffstat manpage</a></li>\n</ul>","frontmatter":{"title":"GitHub 中的 diffstat 所代表的含义？","date":"January 13, 2022","description":"解释下 GitHub 中的 diffstat 柱状图的含义","banner":{"url":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/a096e24fe65415633e3ee51fa1d8a923/16b4e/banner.png","srcSet":"/static/a096e24fe65415633e3ee51fa1d8a923/48571/banner.png 618w,\n/static/a096e24fe65415633e3ee51fa1d8a923/2409d/banner.png 1235w,\n/static/a096e24fe65415633e3ee51fa1d8a923/16b4e/banner.png 2470w","sizes":"(min-width: 2470px) 2470px, 100vw"},"sources":[{"srcSet":"/static/a096e24fe65415633e3ee51fa1d8a923/9ea4c/banner.webp 618w,\n/static/a096e24fe65415633e3ee51fa1d8a923/59c81/banner.webp 1235w,\n/static/a096e24fe65415633e3ee51fa1d8a923/750d1/banner.webp 2470w","type":"image/webp","sizes":"(min-width: 2470px) 2470px, 100vw"}]},"width":2470,"height":960}}},"pattern":"top","placement":null}}},"previous":null,"next":null},"pageContext":{"id":"0c75baa4-02a5-52ff-8e59-3e4c42ea8db6","previousPostId":null,"nextPostId":null}},
    "staticQueryHashes": ["2841359383","3257411868"]}