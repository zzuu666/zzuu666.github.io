<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[ZZUU's blog RSS Feed]]></title><description><![CDATA[忙忙碌碌倒不如走走游游]]></description><link>https://zzuu666.com</link><generator>GatsbyJS</generator><lastBuildDate>Thu, 13 Jan 2022 17:46:01 GMT</lastBuildDate><item><title><![CDATA[GitHub 中的 diffstat 所代表的含义？]]></title><description><![CDATA[diffstat 是什么？ 在 GitHub 中 diffstat 会以 5 个方块组成的柱状图（diffstat histogram）的形式展示，如封面图中的
■■■■■。 在 Git 中的 diffstat…]]></description><link>https://zzuu666.com/explain-diffstat/</link><guid isPermaLink="false">https://zzuu666.com/explain-diffstat/</guid><pubDate>Thu, 13 Jan 2022 16:41:28 GMT</pubDate><content:encoded>&lt;h2&gt;diffstat 是什么？&lt;/h2&gt;
&lt;p&gt;在 GitHub 中 diffstat 会以 5 个方块组成的柱状图（diffstat histogram）的形式展示，如封面图中的
&lt;span class=&quot;text-green-600&quot;&gt;■■■&lt;/span&gt;&lt;span class=&quot;text-gray-400&quot;&gt;■■&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;在 Git 中的 diffstat 则是以 &lt;span class=&quot;text-green-600&quot;&gt;++++&lt;/span&gt;&lt;span class=&quot;text-red-600&quot;&gt;---&lt;/span&gt; 来展示。&lt;/p&gt;
&lt;p&gt;可以通过指令 &lt;code class=&quot;language-text&quot;&gt;git diff --stat&lt;/code&gt; 来查看。&lt;/p&gt;
&lt;h2&gt;diffstat 是怎么计算出来的？&lt;/h2&gt;
&lt;p&gt;约定以下 3 个名词：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;changes: 文件变更的总行数&lt;/li&gt;
&lt;li&gt;additions: 文件变更中增加的行数&lt;/li&gt;
&lt;li&gt;deletions: 文件变更减少的行数&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以及控制台输出时&lt;a href=&quot;https://invisible-island.net/diffstat/manpage/diffstat.html#h2-OPTIONS&quot;&gt;默认的&lt;/a&gt;柱状图最大宽度 &lt;code class=&quot;language-text&quot;&gt;80&lt;/code&gt; 下文以 &lt;code class=&quot;language-text&quot;&gt;columns&lt;/code&gt; 代替。&lt;/p&gt;
&lt;p&gt;那么计算过程的伪代码如下&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; changes &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; columns
  adjust &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; columns &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; changes
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
  adjust &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# + 字符数量，仅取整数部分&lt;/span&gt;
addition_char_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; floor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;additions &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; adjust&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# - 字符数量，仅取整数部分&lt;/span&gt;
deletion_char_count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; floor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;deletions &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; adjust&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以 &lt;code class=&quot;language-text&quot;&gt;12 changes, 8 additions, 4 deletions&lt;/code&gt; 为例，可以得到结果为 &lt;span class=&quot;text-green-600&quot;&gt;++++++++&lt;/span&gt;&lt;span class=&quot;text-red-600&quot;&gt;----&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;但如果将 &lt;code class=&quot;language-text&quot;&gt;12 changes, 8 additions, 4 deletions&lt;/code&gt; 的 &lt;code class=&quot;language-text&quot;&gt;columns&lt;/code&gt; 设置为 5 呢？&lt;/p&gt;
&lt;p&gt;这样上述公式中的 &lt;code class=&quot;language-text&quot;&gt;adjust&lt;/code&gt; 则会变为 &lt;code class=&quot;language-text&quot;&gt;0.417&lt;/code&gt;，经计算得 &lt;code class=&quot;language-text&quot;&gt;additions&lt;/code&gt; 为 &lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;，&lt;code class=&quot;language-text&quot;&gt;deletions&lt;/code&gt; 为 &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;，即可得到 &lt;span class=&quot;text-green-600&quot;&gt;■■■&lt;/span&gt;&lt;span class=&quot;text-red-600&quot;&gt;■&lt;/span&gt;，为了保持 5 个方块的长度，将缺少部分用灰色补充，就可以得到 GitHub 样式的 diffstat 柱状图 &lt;span class=&quot;text-green-600&quot;&gt;■■■&lt;/span&gt;&lt;span class=&quot;text-red-600&quot;&gt;■&lt;/span&gt;&lt;span class=&quot;text-gray-400&quot;&gt;■&lt;/span&gt;。&lt;/p&gt;
&lt;h2&gt;相关资料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.blog/2010-01-12-improved-commit-diffs/&quot;&gt;[GitHub Blog] Improved Commit Diffs#Diffstats&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://invisible-island.net/diffstat/manpage/diffstat.html&quot;&gt;diffstat manpage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>